#!/usr/bin/env bash
set -euo pipefail

if ! command -v docker >/dev/null 2>&1; then
  echo "Docker не установлен или недоступен" >&2
  exit 1
fi

if ! command -v docker compose >/dev/null 2>&1; then
  echo "Docker Compose V2 недоступен" >&2
  exit 1
fi

cid=$(docker compose ps -q app || true)

if [ -n "${cid}" ]; then
  exec docker compose exec app php artisan "$@"
else
  exec docker compose run --rm app php artisan "$@"
fi